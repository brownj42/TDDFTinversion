<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>systemparameters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark border-bottom">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./density.html" class="sidebar-item-text sidebar-link">density</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./derivedtypes.html" class="sidebar-item-text sidebar-link">derivedtypes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fullvalues.html" class="sidebar-item-text sidebar-link">fullvalues derived type</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./initial_states.html" class="sidebar-item-text sidebar-link">initial_states</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./keomod.html" class="sidebar-item-text sidebar-link">keomod</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ksvalues.html" class="sidebar-item-text sidebar-link">ksvalues derived type</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potential.html" class="sidebar-item-text sidebar-link">potential</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propagate.html" class="sidebar-item-text sidebar-link">propagate</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sharedvalues.html" class="sidebar-item-text sidebar-link">sharedvalues derived type</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./systemparameters.html" class="sidebar-item-text sidebar-link active">systemparameters derived type</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="systemparameters-derived-type" class="level1">
<h1>systemparameters derived type</h1>
<p>This describes each of the values located in the systemparameters derived type.</p>
<section id="initialization" class="level2">
<h2 class="anchored" data-anchor-id="initialization">Initialization</h2>
<p>This derived type (labelled sysparams here) is initialized using np1 (the number of grid points)</p>
<p>Fortran</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">type(systemparameters)</span> <span class="dt">::</span> sysparams</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> <span class="dt">::</span> np1</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">call</span> init_systemparameters(sysparams,np1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>np1<span class="op">=</span>numpy.int32( )</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sysparams<span class="op">=</span>TDDFTinversion.derivedtypes.init_systemparameters(np1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The systemparameters derived type will now have the np1 value defined</p>
<section id="np1" class="level3">
<h3 class="anchored" data-anchor-id="np1">np1</h3>
<section id="description" class="level4">
<h4 class="anchored" data-anchor-id="description">Description</h4>
<p>The number of grid points in each dimension</p>
</section>
<section id="data-type" class="level4">
<h4 class="anchored" data-anchor-id="data-type">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="mandatory-values-defined-by-user-in-program-that-calls-library" class="level2">
<h2 class="anchored" data-anchor-id="mandatory-values-defined-by-user-in-program-that-calls-library">Mandatory values defined by user in program that calls library</h2>
<p>After initialization, user must add the following parameters to the derived type using commands such as</p>
<p>Fortran</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sysparams%<span class="dt">value</span><span class="kw">=</span>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sysparams.value<span class="op">=</span>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="nd" class="level3">
<h3 class="anchored" data-anchor-id="nd">nd</h3>
<section id="description-1" class="level4">
<h4 class="anchored" data-anchor-id="description-1">Description</h4>
<p>The number of dimensions that each particle lives in. For first quantization, only 1,2, or 3 dimensions is allowed. For second quantization, only 1 dimension is allowed.</p>
</section>
<section id="data-type-1" class="level4">
<h4 class="anchored" data-anchor-id="data-type-1">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="npart" class="level3">
<h3 class="anchored" data-anchor-id="npart">npart</h3>
<section id="description-2" class="level4">
<h4 class="anchored" data-anchor-id="description-2">Description</h4>
<p>The number of particles in the total system</p>
</section>
<section id="data-type-2" class="level4">
<h4 class="anchored" data-anchor-id="data-type-2">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="xmin" class="level3">
<h3 class="anchored" data-anchor-id="xmin">xmin</h3>
<section id="description-3" class="level4">
<h4 class="anchored" data-anchor-id="description-3">Description</h4>
<p>The min position of the grid points that define the lattice with equal spacing of length n</p>
</section>
<section id="data-type-3" class="level4">
<h4 class="anchored" data-anchor-id="data-type-3">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="xmax" class="level3">
<h3 class="anchored" data-anchor-id="xmax">xmax</h3>
<section id="description-4" class="level4">
<h4 class="anchored" data-anchor-id="description-4">Description</h4>
<p>The min position of the grid points that define the lattice with equal spacing of length n</p>
</section>
<section id="data-type-4" class="level4">
<h4 class="anchored" data-anchor-id="data-type-4">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dth" class="level3">
<h3 class="anchored" data-anchor-id="dth">dth</h3>
<section id="description-5" class="level4">
<h4 class="anchored" data-anchor-id="description-5">Description</h4>
<p>The goal time step for the program. If an advance of the KS system fails, the actual time step will be less than this for the next attempt. However, the program will attempt to increase the time step back to this user defined timestep on future calls of the program.</p>
</section>
<section id="data-type-5" class="level4">
<h4 class="anchored" data-anchor-id="data-type-5">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="t" class="level3">
<h3 class="anchored" data-anchor-id="t">T</h3>
<section id="description-6" class="level4">
<h4 class="anchored" data-anchor-id="description-6">Description</h4>
<p>The one dimensional kinetic energy operator. For the sinc basis one can use Fortran</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">call</span> buildkeo(sysparams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>TDDFTinversion.keomod.buildkeo(sysparams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>after defining xmax and xmin</p>
</section>
<section id="data-type-6" class="level4">
<h4 class="anchored" data-anchor-id="data-type-6">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span>, <span class="dt">dimension(np1,np1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>numpy.empty([np1,np1],dtype<span class="op">=</span>numpy.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="values-that-may-be-initially-defined-by-the-user" class="level2">
<h2 class="anchored" data-anchor-id="values-that-may-be-initially-defined-by-the-user">Values that may be initially defined by the user</h2>
<p>These are values that may be initially defined by the user but should not be changed after the first call to propagate the KS system.</p>
<section id="ct" class="level3">
<h3 class="anchored" data-anchor-id="ct">ct</h3>
<section id="description-7" class="level4">
<h4 class="anchored" data-anchor-id="description-7">Description</h4>
<p>The current time in the propagation. Initialized to 0 by program.</p>
</section>
<section id="data-type-7" class="level4">
<h4 class="anchored" data-anchor-id="data-type-7">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dt" class="level3">
<h3 class="anchored" data-anchor-id="dt">dt</h3>
<section id="description-8" class="level4">
<h4 class="anchored" data-anchor-id="description-8">Description</h4>
<p>The current time-step size. Initially set to dth by program. It is often beneficial to start the propagation with a smaller time step so as to obtain the time derivative of the potential more accurately.</p>
</section>
<section id="data-type-8" class="level4">
<h4 class="anchored" data-anchor-id="data-type-8">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="quantization" class="level3">
<h3 class="anchored" data-anchor-id="quantization">quantization</h3>
<section id="description-9" class="level4">
<h4 class="anchored" data-anchor-id="description-9">Description</h4>
<p>If quantization = 1 then first quantization is used. If quantization =2 then second quantization is used. First quantization can be used for #nd=1,2,3 while second quantization can only be used for nd=1. Default is 1.</p>
</section>
<section id="data-type-9" class="level4">
<h4 class="anchored" data-anchor-id="data-type-9">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="values-that-may-be-altered-at-any-time." class="level2">
<h2 class="anchored" data-anchor-id="values-that-may-be-altered-at-any-time.">Values that may be altered at any time.</h2>
<section id="energy" class="level3">
<h3 class="anchored" data-anchor-id="energy">energy</h3>
<section id="description-10" class="level4">
<h4 class="anchored" data-anchor-id="description-10">Description</h4>
<p>The energy of KS system is rescaled to this value by shifting the calculated potential. If there is no energy imparted on the full system by a time-dependant potential than this value should be chosen to be some initial value and then not changed. Otherwise, a good choice may be to measure the full system’s energy at the beginning and end of each time step and use that value. Default is 0.</p>
</section>
<section id="data-type-10" class="level4">
<h4 class="anchored" data-anchor-id="data-type-10">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="energynew" class="level3">
<h3 class="anchored" data-anchor-id="energynew">energynew</h3>
<section id="description-11" class="level4">
<h4 class="anchored" data-anchor-id="description-11">Description</h4>
<p>The energy of KS system after time step dt is rescaled to this value by shifting the calculated potential. If there is no energy imparted on the full system by a time-dependant potential than this value should be chosen to be some initial value and then not changed. Otherwise, a good choice may be to measure the full system’s energy at the beginning and end of each time step and use that value. Default is 0. After call to fill_systemparameters, value is equal to energy.</p>
</section>
<section id="data-type-11" class="level4">
<h4 class="anchored" data-anchor-id="data-type-11">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="pinv0minresqlp1" class="level3">
<h3 class="anchored" data-anchor-id="pinv0minresqlp1">pinv0minresqlp1</h3>
<section id="description-12" class="level4">
<h4 class="anchored" data-anchor-id="description-12">Description</h4>
<p>The parameter that determines which method is used to invert the potential. The recommended and initial setting is 1 which uses MINRES-QLP. If you are in 1D, setting pinv0minresqlp1 will utilize the Morse-Penrose pseudo inverse.</p>
</section>
<section id="data-type-12" class="level4">
<h4 class="anchored" data-anchor-id="data-type-12">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="singlet" class="level3">
<h3 class="anchored" data-anchor-id="singlet">singlet</h3>
<section id="description-13" class="level4">
<h4 class="anchored" data-anchor-id="description-13">Description</h4>
<p>The parameter defines the symmetry for a two particle first quantized system with singlet symmetry. 0 means singlet symmetry is not enforced. 1 means singlet symmetry is enforced. Default is 0.</p>
</section>
<section id="data-type-13" class="level4">
<h4 class="anchored" data-anchor-id="data-type-13">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="triplet" class="level3">
<h3 class="anchored" data-anchor-id="triplet">triplet</h3>
<section id="description-14" class="level4">
<h4 class="anchored" data-anchor-id="description-14">Description</h4>
<p>The parameter defines the symmetry for a two particle first quantized system with triplet symmetry. 0 means triplet symmetry is not enforced. 1 means triplet symmetry is enforced. Default is 0.</p>
</section>
<section id="data-type-14" class="level4">
<h4 class="anchored" data-anchor-id="data-type-14">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dvksmax" class="level3">
<h3 class="anchored" data-anchor-id="dvksmax">dvksmax</h3>
<section id="description-15" class="level4">
<h4 class="anchored" data-anchor-id="description-15">Description</h4>
<p>The maximum time derivative of the inverted potential at a given point. The initial value is 1000.</p>
</section>
<section id="data-type-15" class="level4">
<h4 class="anchored" data-anchor-id="data-type-15">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="newfile" class="level3">
<h3 class="anchored" data-anchor-id="newfile">newfile</h3>
<section id="description-16" class="level4">
<h4 class="anchored" data-anchor-id="description-16">Description</h4>
<p>The flag that determines whether the output of data will be in a newfile or appended to the previous files. If set to 1, the old files will be overwritten. Otherwise, the new data will be appended to the old files.The description of the output files is in the main <a href="./index.html">index</a> newfile is initialized to 1 and then after every time data is written reverts to 0.</p>
</section>
<section id="data-type-16" class="level4">
<h4 class="anchored" data-anchor-id="data-type-16">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="outputdata" class="level3">
<h3 class="anchored" data-anchor-id="outputdata">outputdata</h3>
<section id="description-17" class="level4">
<h4 class="anchored" data-anchor-id="description-17">Description</h4>
<p>The flag that determines whether the current Kohn-Sham values will be outputted to data files. If set to 1, the data will be written to file. Otherwise, no data will be written.</p>
</section>
<section id="data-type-17" class="level4">
<h4 class="anchored" data-anchor-id="data-type-17">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="values-calculated-by-program" class="level2">
<h2 class="anchored" data-anchor-id="values-calculated-by-program">Values calculated by program</h2>
<p>The following are systemparameter values that are accessible to the user but should not be altered. They are determined by the program by Fortran</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">call</span> fill_systemparameters(sysparams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>TDDFTinversion.derivedtypes.fill_systemparameters(sysparams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="ntot1" class="level3">
<h3 class="anchored" data-anchor-id="ntot1">ntot1</h3>
<section id="description-18" class="level4">
<h4 class="anchored" data-anchor-id="description-18">Description</h4>
<p>The number of grid points that defines each particle. np1<sup>nd</sup></p>
</section>
<section id="data-type-18" class="level4">
<h4 class="anchored" data-anchor-id="data-type-18">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="ntot2" class="level3">
<h3 class="anchored" data-anchor-id="ntot2">ntot2</h3>
<section id="description-19" class="level4">
<h4 class="anchored" data-anchor-id="description-19">Description</h4>
<p>The number of grid points that defines two particles. np1<sup>2 nd</sup></p>
</section>
<section id="data-type-19" class="level4">
<h4 class="anchored" data-anchor-id="data-type-19">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="ntot" class="level3">
<h3 class="anchored" data-anchor-id="ntot">ntot</h3>
<section id="description-20" class="level4">
<h4 class="anchored" data-anchor-id="description-20">Description</h4>
<p>The number of grid points that defines the full system wavefunction.<br>
If in first quantization: ntot=ntot1<sup>npart</sup><br>
If in second quantization: ntot=ntot1 choose npart</p>
</section>
<section id="data-type-20" class="level4">
<h4 class="anchored" data-anchor-id="data-type-20">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dt">integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>numpy.int32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dx" class="level3">
<h3 class="anchored" data-anchor-id="dx">dx</h3>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<p>The grid spacing. (xmax-xmin)/(np1-1)</p>
</section>
<section id="data-type-21" class="level4">
<h4 class="anchored" data-anchor-id="data-type-21">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>numpy.float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="xlattice" class="level3">
<h3 class="anchored" data-anchor-id="xlattice">xlattice</h3>
<section id="description-21" class="level4">
<h4 class="anchored" data-anchor-id="description-21">Description</h4>
<p>The equally spaced grid points for one dimension defined by xmin,xmax and np1.</p>
</section>
<section id="data-type-22" class="level4">
<h4 class="anchored" data-anchor-id="data-type-22">Data type</h4>
<p>Fortran</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode f90 code-with-copy"><code class="sourceCode fortranfree"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="dt">real(8)</span>, <span class="dt">dimension(sysparams%np1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>numpy.empty([sysparams<span class="op">%</span>np1,<span class="dv">1</span>],dtype<span class="op">=</span>numpy.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>